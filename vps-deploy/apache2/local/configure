#!/bin/bash

PORT1=80
PORT2=8080

config() {
    APP=$1
    if [ ! -f "${APP}.conf" ]; then
        echo "unknown app, example file unexist"
        exit
    fi

    grep -q -e "Listen ${PORT1}" /etc/apache2/ports.conf || echo "Listen ${PORT1}" >> /etc/apache2/ports.conf
    grep -q -e "Listen ${PORT2}" /etc/apache2/ports.conf || echo "Listen ${PORT2}" >> /etc/apache2/ports.conf
    cp ${APP}.conf /etc/apache2/sites-available/

    a2ensite ${APP}
    a2enmod proxy_http
    apache2ctl configtest
    systemctl restart apache2
}

disable() {
    APP=$1
    rm -f /etc/apache2/sites-available/${APP}.conf
    rm -f /etc/apache2/sites-enabled/${APP}.conf
    systemctl restart apache2
}

case $1 in 
    "disable")
        disable $2
        ;;
    *)
        config $1
        ;;
esac
